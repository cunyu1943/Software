[TOC]

## 1. 数据库准备

1.  首先，我们来创建一个数据库，用于后序步骤的使用；

```sql
CREATE DATABASE test;
USE test;
```

2.  接着创建一个表，用于存放数据；

```sql
CREATE TABLE user (
	id int(20) NOT NULL AUTO_INCREMENT,
    name varchar(30) DEFAULT NULL,
    password varchar(30) DEFAULT NULL,
    PRIMARY KEY (id)
);
```

3.  向数据库中插入数据

```sql
INSERT INTO user (id, name, password) VALUES (1, '村雨遥', '123456'),(2, '张三', '1234567'),(3, '李四', '12345678');
```

## 2. 创建 Maven 工程

1.  对于如何创建 Maven 工程，可以参照 [用 IDEA 创建 Maven 版 HelloWorld！](https://mp.weixin.qq.com/s?__biz=MzIyNTg2MjkzNw==&mid=2247490240&idx=1&sn=fac6aa95f26c87f2a0cd122625991f2f&chksm=e8786eb6df0fe7a0c814d453e3a6b5ac5e4fce816b39ff36413aa5e0f02ac14896411897f70d#rd)
2.  接着在项目的 `pom.xml` 中添加 MyBatis、MySQL、Junit 的依赖；

```xml
<dependency>
    <groupId>org.mybatis</groupId>
    <artifactId>mybatis</artifactId>
    <version>3.5.5</version>
</dependency>
<dependency>
    <groupId>mysql</groupId>
    <artifactId>mysql-connector-java</artifactId>
    <version>5.1.49</version>
</dependency>
<dependency>
	<groupId>junit</groupId>
	<artifactId>junit</artifactId>
	<version>4.13</version>
	<scope>test</scope>
</dependency>
```

## 3. 编写 MyBatis 实例

1.  编写 MyBatis 核心配置文件，在 `main/resources` 文件下新建 `mybatis-config.xml` ，配置数据库；

```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE configuration
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-config.dtd">
<configuration>
    <environments default="development">
        <environment id="development">
            <transactionManager type="JDBC"/>
            <dataSource type="POOLED">
                <property name="driver" value="com.mysql.jdbc.Driver"/>
                <property name="url"
                          value="jdbc:mysql://localhost:3306/test?useSSL=false&amp;useUnicode=true&amp;characterEncoding=utf8"/>
                <property name="username" value="root"/>
                <property name="password" value="12345"/>
            </dataSource>
        </environment>
    </environments>

    <mappers>
        <mapper resource="UserMapper.xml"/>
    </mappers>
</configuration>
```

2.  编写 MyBatis 工具类；

```java
package com.cunyu.utils;

import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;

import java.io.IOException;
import java.io.InputStream;

/**
 * @author : cunyu
 * @version : 1.0
 * @className : MyBatisUtils
 * @date : 2020/7/14 11:38
 * @description : MyBatis 工具类
 */

public class MyBatisUtils {
    private static SqlSessionFactory sqlSessionFactory;

    static {
        try {
            String resource = "mybatis-config.xml";
            InputStream inputStream = Resources.getResourceAsStream(resource);
            sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    /**
     * @param
     * @return
     * @description 获取 SqlSession 连接
     * @date 2020/7/14 11:46
     * @author cunyu1943
     * @version 1.0
     */
    public static SqlSession getSession() {
        return sqlSessionFactory.openSession();
    }
}
```

3.  接下来创建实体类；

```java
package com.cun.pojo;

/**
 * @author : cunyu
 * @version : 1.0
 * @className : User
 * @date : 2020/7/14 11:55
 * @description : User 实体类
 */

public class User {
    private int id;
    private String name;
    private String password;

    public User() {
    }

    public User(int id, String name, String password) {
        this.id = id;
        this.name = name;
        this.password = password;
    }

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    @Override
    public String toString() {
        return "User{" +
                "id=" + id +
                ", name='" + name + '\'' +
                ", password='" + password + '\'' +
                '}';
    }
}
```

4.  编写 Mapper 接口；

```java
package com.cunyu.dao;

import com.cunyu.pojo.User;

import java.util.List;

/**
 * @InterfaceName : UserDao
 * @Author : cunyu
 * @Date : 2020/7/14 13:49
 * @Version : 1.0
 * @Description : User 接口
 **/

public interface UserDao {
    List<User> getUser();
}
```

5.  添加 `UserMapper.xml` 配置文件；

```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--绑定对应Dao/Mapper接口-->
<mapper namespace="com.cunyu.dao.UserDao">
    <select id="getUser" resultType="com.cunyu.pojo.User">
        select * from user
    </select>
</mapper>
```

6.  编写测试类，在 `src/test/java/` 目录下保持相同的目录结构，然后添加测试类进行测试；

```java
package com.cunyu.dao;

import com.cunyu.pojo.User;
import com.cunyu.utils.MybatisUtils;
import org.apache.ibatis.session.SqlSession;
import org.junit.Test;

import java.util.List;

/**
 * @author : cunyu
 * @version : 1.0
 * @className : UserDaoTest
 * @date : 2020/7/14 13:52
 * @description : UserDao 接口测试
 */

public class UserDaoTest {
    @Test
    public void test(){
        // 获取 SqlSession 对象
        SqlSession sqlSession = MybatisUtils.getSqlSession();

        // 执行 SQL 语句
        UserDao mapper = sqlSession.getMapper(UserDao.class);
        List<User> userList = mapper.getUser();

        for (User user:userList
             ) {
            System.out.println(user);
        }

        // 关闭 SqlSession
        sqlSession.close();
    }
}
```

7.  运行测试类，可以得出如下结果；

![](https://s1.ax1x.com/2020/07/14/UNv6r6.png)

![](https://gitee.com/cunyu1943/images/raw/master/ImgsUbuntu/20200510234310.png)

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">

<center><div class="social-share"></div></center>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>

