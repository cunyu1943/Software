[TOC]

## 1. 属性名与字段不一致

在我们进行开发时，经常会遇见数据库中的字段名和类中的属性名不一致的情况，针对该种情况，当我们使用 MyBatis 进行开发时，通常有如下两种解决方案：

1.  **指定别名**；
2.  **使用 `ResultMap`**

### 1.1 指定别名

第一种方案是为数据库的字段名指定别名 , 让它和类中的属性名保持一致。即在 `UserMapper.xml` 中修改即可。我的数据库中字段名为 `name`，假设此时类中属性名为 `userName`，我们可以像下面一样修改；

```xml
<select id="selectUserById" resultType="User">
    select id , name as userName , password from user where id = #{id}
</select>
```

### 1.2 使用 `ResultMap`

```xml
<resultMap id="UserMap" type="User">
    <!--    id 对应主键，column 对应数据库字段，property 对应类属性    -->
    <id column="id" property="id"/>
    <result column="name" property="userName"/>
    <result column="password" property="password"/>
</resultMap>

<select id="getUserById" resultMap="UserMap">
    select id,name,password from user where id = #{id};
</select>
```

## 2. 分页

当我们利用 MyBatis 对数据库进行查询操作时，如果查询数据较多，我们往往需要使用分页进行查询，即每次处理一部分数据，从而减小服务器的压力。

### 2.1 Limit 关键字

直接在 SQL 语句中使用 `Limit` ，从而实现结果分页：

```sql
SELECT * FROM table LIMIT startIndex, pageSize
```

1.  接口中添加方法；

```java
List<User> getAllUser(Map<String, Integer> map);
```

2.  修改 `mapper` 中的 SQL 语句；

```xml
<select id="getAllUser" resultType="com.cunyu.pojo.User">
    select * from user limit #{startIndex},#{pageSize}
</select>
```

3.  测试

```java
@Test
public void testGetAllUser() {
    SqlSession sqlSession = MybatisUtils.getSqlSession();
    UserDao mapper = sqlSession.getMapper(UserDao.class);

    // 当前页
    int currentPage = 1;
    // 每页显示的数量
    int pageSize = 1;

    Map<String, Integer> map = new HashMap<String, Integer>();
    // 起始位置
    map.put("startIndex", (currentPage - 1) * pageSize);
    map.put("pageSize", pageSize);

    List<User> userList = mapper.getAllUser(map);
    for (User user : userList
        ) {
        System.out.println(user);
    }

    sqlSession.close();
}
```

### 2.2 RowBounds 分页

既然可以实现在 SQL 中进行限制来分页，那么也可以在 Java 代码层中来实现分页；

1.  接口中添加方法；

```java
List<User> getUserByRowBounds();
```

2.  `mapper` 文件中绑定；

```xml
<select id="getUserByRowBounds" resultType="user">
  select * from user
</select>
```

3.  测试

```java
@Test
public void testUserByRowBounds() {
    SqlSession sqlSession = MybatisUtils.getSession();
 
    int currentPage = 1;
    //每页显示数量
    int pageSize = 2;  
    RowBounds rowBounds = new RowBounds((currentPage-1) * pageSize, pageSize);
 
    List<User> users = sqlSession.selectList("com.cunyu.dao.UserDao.getUserByRowBounds", null, rowBounds);
 
    for (User user: users){
        System.out.println(user);
    }
    sqlSession.close();
}
```

### 2.3 PageHelper

不同于前两种方式，这是一个分页插件，具体使用方法可以参照其提供的文档：[如何使用分页插件](https://pagehelper.github.io/docs/howtouse/)

1.  首先添加 POM 依赖，在 `pom.xml` 中添加如下内容；

```xml
<dependency>
    <groupId>com.github.pagehelper</groupId>
    <artifactId>pagehelper</artifactId>
    <version>5.1.11</version>
</dependency>
```

2.  在 MyBatis 的配置文件 `mybatis-config.xml` 中进行配置拦截器插件；

```xml
<plugins>
    <!-- com.github.pagehelper为PageHelper类所在包名 -->
    <plugin interceptor="com.github.pagehelper.PageInterceptor">
        <property name="dialect" value="mysql"/>
        <property name="offsetAsPageNum" value="false"/>
        <property name="rowBoundsWithCount" value="false"/>
        <property name="pageSizeZero" value="true"/>
        <property name="reasonable" value="false"/>
        <property name="supportMethodsArguments" value="false"/>
        <property name="returnPageInfo" value="none"/>
    </plugin>
</plugins>
```

3.  实现分页即可； 

![](https://gitee.com/cunyu1943/images/raw/master/ImgsUbuntu/20200510234310.png)

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">

<center><div class="social-share"></div></center>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>

